kingdomkey={name="Kingdom Key",id=0x00,bit=0x00,cp={19,10,11,12,13,14,15,16,17,18}}
threewishes={name="Three Wishes",id=0x0A,bit=0x01,cp={24,15,16,17,18,19,20,21,22,23}}
crabclaw={name="Crabclaw",id=0x14,bit=0x02,cp={38,20,22,24,26,28,30,32,34,36}}
pumpkinhead={name="Pumpkinhead",id=0x1E,bit=0x03,cp={24,15,16,17,18,19,20,21,22,23}}
fairyharp={name="Fairy Harp",id=0x28,bit=0x04,cp={38,20,22,24,26,28,30,32,34,36}}
wishingstar={name="Wishing Star",id=0x32,bit=0x05,cp={24,15,16,17,18,19,20,21,22,23}}
spellbinder={name="Spellbinder",id=0x3C,bit=0x06,cp={38,20,22,24,26,28,30,32,34,36}}
metalchocobo={name="Metal Chocobo",id=0x46,bit=0x07,cp={38,20,22,24,26,28,30,32,34,36}}
olympia={name="Olympia",id=0x50,bit=0x08,cp={24,15,16,17,18,19,20,21,22,23}}
lionheart={name="Lionheart",id=0x5A,bit=0x09,cp={38,20,22,24,26,28,30,32,34,36}}
ladyluck={name="Lady Luck",id=0x64,bit=0x0A,cp={24,15,16,17,18,19,20,21,22,23}}
divinerose={name="Divine Rose",id=0x6E,bit=0x0B,cp={38,20,22,24,26,28,30,32,34,36}}
oathkeeper={name="Oathkeeper",id=0x78,bit=0x0C,cp={43,25,27,29,31,33,35,37,39,41}}
oblivion={name="Oblivion",id=0x82,bit=0x0D,cp={43,25,27,29,31,33,35,37,39,41}}
diamonddust={name="Diamond Dust",id=0x8C,bit=0x0F,cp={43,25,27,29,31,33,35,37,39,41}}
onewingedangel={name="One-Winged Angel",id=0x96,bit=0x10,cp={43,25,27,29,31,33,35,37,39,41}}
ultimaweapon={name="Ultima Weapon",id=0xA0,bit=0x0E,cp={57,30,33,36,39,42,45,48,51,54}}
fire={name="Fire",id=0xAA,bit=0x11,cp={24,15,16,17,18,19,20,21,22,23}}
blizzard={name="Blizzard",id=0xB4,bit=0x12,cp={24,15,16,17,18,19,20,21,22,23}}
thunder={name="Thunder",id=0xBE,bit=0x13,cp={24,15,16,17,18,19,20,21,22,23}}
cure={name="Cure",id=0xC8,bit=0x14,cp={43,25,27,29,31,33,35,37,39,41}}
gravity={name="Gravity",id=0xD2,bit=0x15,cp={38,20,22,24,26,28,30,32,34,36}}
stop={name="Stop",id=0xDC,bit=0x16,cp={38,20,22,24,26,28,30,32,34,36}}
aero={name="Aero",id=0xE6,bit=0x17,cp={38,20,22,24,26,28,30,32,34,36}}
simba={name="Simba",id=0x104,bit=0x18,cp={38,20,22,24,26,28,30,32,34,36}}
genie={name="Genie",id=0x10E,bit=0x19,cp={38,20,22,24,26,28,30,32,34,36}}
bambi={name="Bambi",id=0x118,bit=0x1A,cp={38,20,22,24,26,28,30,32,34,36}}
dumbo={name="Dumbo",id=0x122,bit=0x1B,cp={38,20,22,24,26,28,30,32,34,36}}
tinkerbell={name="Tinker Bell",id=0x12C,bit=0x1C,cp={38,20,22,24,26,28,30,32,34,36}}
mushu={name="Mushu",id=0x136,bit=0x1D,cp={43,25,27,29,31,33,35,37,39,41}}
cloud={name="Cloud",id=0x140,bit=0x1E,cp={43,25,27,29,31,33,35,37,39,41}}
potion={name="Potion",id=0x17C,bit=0x1F,cp={57,30,33,36,39,42,45,48,51,54}}
hipotion={name="Hi-Potion",id=0x186,bit=0x20,cp={76,40,44,48,52,56,60,64,68,72}}
megapotion={name="Mega-Potion",id=0x190,bit=0x21,cp={81,45,49,53,57,61,65,69,73,77}}
ether={name="Ether",id=0x19A,bit=0x22,cp={38,20,22,24,26,28,30,32,34,36}}
megaether={name="Mega-Ether",id=0x1A4,bit=0x23,cp={62,35,38,41,44,47,50,53,56,59}}
elixir={name="Elixir",id=0x1AE,bit=0x24,cp={81,45,49,53,57,61,65,69,73,77}}
megalixir={name="Megalixir",id=0x1B8,bit=0x25,cp={95,50,55,60,65,70,75,80,85,90}}

shadow={name="Shadow",id=0x1C2,address=0xF7D638}
soldier={name="Soldier",id=0x1C5,address=0xF7D644}
largebody={name="Large Body",id=0x1C8,address=0xF7D680}
rednocturne={name="Red Nocturne",id=0x1CB,address=0xF7D650}
bluerhapsody={name="Blue Rhapsody",id=0x1CE,address=0xF7D65C}
yellowopera={name="Yellow Opera",id=0x1D1,address=0xF7D668}
greenrequiem={name="Green Requiem",id=0x1D4,address=0xF7D674}
powerwild={name="Powerwild",id=0x1D7,address=0xF7D6DC}
bouncywild={name="Bouncywild",id=0x1DA,address=0xF7D6E8}
airsoldier={name="Air Soldier",id=0x1DD,address=0xF7D808}
bandit={name="Bandit",id=0x1E0,address=0xF7D6F4}
fatbandit={name="Fat Bandit",id=0x1E3,address=0xF7D748}
barrelspider={name="Barrel Spider",id=0x1E6,address=0xF7D68C}
searchghost={name="Search Ghost",id=0x1E9,address=0xF7D700}
seaneon={name="Sea Neon",id=0x1EC,address=0xF7D6D0}
screwdiver={name="Screwdiver",id=0x1EF,address=0xF7D70C}
aquatank={name="Aquatank",id=0x1F2,address=0xF7D754}
wightknight={name="Wight Knight",id=0x1F5,address=0xF7D718}
gargoyle={name="Gargoyle",id=0x1F8,address=0xF7D724}
pirate={name="Pirate",id=0x1FB,address=0xF7D730}
airpirate={name="Air Pirate",id=0x1FE,address=0xF7D7FC}
darkball={name="Darkball",id=0x201,address=0xF7D73c}
defender={name="Defender",id=0x204,address=0xF7D760}
wyvern={name="Wyvern",id=0x207,address=0xF7D814}
wizard={name="Wizard",id=0x20A,address=0xF7D698}
neoshadow={name="Neoshadow",id=0x20D,address=0xF7D7BC}
whitemushroom={name="White Mushroom",id=0x210,address=0xF7D7E0}
blackfungus={name="Black Fungus",id=0x211,address=0xF7D7E4}
creeperplant={name="Creeper Plant",id=0x214,address=0xF7D838}
tornadostep={name="Tornado Step",id=0x217,address=0xF7D820}
crescendo={name="Crescendo",id=0x21A,address=0xF7D82C}
guardarmor={name="Guard Armor",id=0x21D,address=0x96AC4}
parasitecage={name="Parasite Cage",id=0x21E,address=0x96AF0}
trickmaster={name="Trickmaster",id=0x21F,address=0x96AD8}
darkside={name="Darkside",id=0x220,address=0x96AFC} --x4
cardsoldier={name="Card Soldier",id=0x221,address=0x96B24}
hades={name="Hades",id=0x227,address=0x96B58}
jafar={name="Jafar",id=0x228,address=0x96AC8} --x4
oogieboogie={name="Oogie Boogie",id=0x229,address=0x96B0C}
ursula={name="Ursula",id=0x22A,address=0x96AE4}
hook={name="Hook",id=0x22B,address=0x96B40}
dragonmaleficent={name="Dragon Maleficent",id=0x22C,address=0x96AF4} --x4
riku={name="Riku",id=0x22D,address=0x96B80}
axel={name="Axel",id=0x22E,address=0x96B8C}
larxene={name="Larxene",id=0x22F,address=0x96B98}
vexen={name="Vexen",id=0x230,address=0x96B9C} --x4
marluxia={name="Marluxia",id=0x231,address=0x96B64}
lexaeus={name="Lexaeus",id=0x233,address=0x18581E6}
ansem={name="Ansem",id=0x234,address=0x18581EA}

--CONFIG
--Set 02039CBC to FF, 02039CC4 to 22, and 02039CC5 to 80 for all level up sleights
spoilers=true
seed=2

oldcards={kingdomkey,threewishes,crabclaw,pumpkinhead,fairyharp,wishingstar,spellbinder,metalchocobo,olympia,lionheart,ladyluck,divinerose,oathkeeper,oblivion,diamonddust,onewingedangel,ultimaweapon,fire,blizzard,thunder,cure,gravity,stop,aero,simba,genie,bambi,dumbo,tinkerbell,mushu,cloud,potion,hipotion,megapotion,ether,megaether,elixir,megalixir}
cards={unpack(oldcards)}
newcards={}

if (seed==0) then
	seed=os.time()
end
print("Seed: "..seed)
math.randomseed(seed)
math.random()
math.random()
math.random()

--TODO:
---Variety of randomization
----Human bosses
----Sleights
----World cards
----Enemies/enemy encounters
----Friend cards
----Heartless bosses??
----Riku's story:
-----Enemy cards
------Bosses seem to check whether you've beaten the corresponding boss, then add the correct card to your deck; not the same as what card actually drops
-----Bosses
-----World cards
-----Set up postgame rewards obtained flags
-----Decks?
-----Friend cards??
-----Enemies/enemy encounters
----Test 100%
---Menu
----Set seed
----Dump codes
----Prompt for spoilers
----Decide which things to randomize
----Save/load
----Give enemies consistent enemy cards? limits enemies to enemies and bosses to bosses
-----Not sure about this, what if all three were set to the same value?
---Clean up code


am=0
sp=0
bound=24
total=38

defaultattack=table.remove(cards,1)
am=am+1

defaultmagic=cure
while defaultmagic==cure or defaultmagic==blizzard do
	i=math.random(17,23)
	defaultmagic=cards[i]
end
table.remove(cards,i)
am=am+1

defaultitem=potion
while defaultitem==potion do
	i=math.random(30,total-(am+sp))
	defaultitem=cards[i]
end
table.remove(cards,i)
sp=sp+1

defaultwild=blizzard
while defaultwild==defaultattack or defaultwild==cure or defaultwild==blizzard or defaultwild==defaultmagic do
	i=math.random(2,bound-am)
	defaultwild=cards[i]
end
table.remove(cards,i)
am=am+1

leonreward=simba
while leonreward==simba do
	i=math.random(bound-am+1,total-(am+sp))
	leonreward=cards[i]
end
table.remove(cards,i)
sp=sp+1

traversetownktr=lionheart
while traversetownktr==lionheart do
	i=math.random(1,bound-am)
	traversetownktr=cards[i]
end
table.remove(cards,i)
am=am+1

axelreward=fire
while axelreward==fire do
	i=math.random(1,bound-am)
	axelreward=cards[i]
end
table.remove(cards,i)
am=am+1

agrabahattack=threewishes
while agrabahattack==threewishes do
	i=math.random(1,bound-am)
	agrabahattack=cards[i]
end
table.remove(cards,i)
am=am+1

agrabahbounty=gravity
while agrabahbounty==gravity do
	i=math.random(1,bound-am)
	agrabahbounty=cards[i]
end
table.remove(cards,i)
am=am+1

banditreward=ether
while banditreward==ether do
	i=math.random(bound-am+1,total-(am+sp))
	banditreward=cards[i]
end
table.remove(cards,i)
sp=sp+1

agrabahreward=genie
while agrabahreward==genie do
	i=math.random(bound-am+1,total-(am+sp))
	agrabahreward=cards[i]
end
table.remove(cards,i)
sp=sp+1

olympusattack=olympia
while olympusattack==olympia do
	i=math.random(1,bound-am)
	olympusattack=cards[i]
end
table.remove(cards,i)
am=am+1

cloudreward=hipotion
while cloudreward==hipotion do
	i=math.random(bound-am+1,total-(am+sp))
	cloudreward=cards[i]
end
table.remove(cards,i)
sp=sp+1

olympusreward=cloud
while olympusreward==cloud do
	i=math.random(bound-am+1,total-(am+sp))
	olympusreward=cards[i]
end
table.remove(cards,i)
sp=sp+1

olympusktr=metalchocobo
while olympusktr==metalchocobo do
	i=math.random(1,bound-am)
	olympusktr=cards[i]
end
table.remove(cards,i)
am=am+1

wonderlandattack=ladyluck
while wonderlandattack==ladyluck do
	i=math.random(1,bound-am)
	wonderlandattack=cards[i]
end
table.remove(cards,i)
am=am+1

wonderlandbounty=stop
while wonderlandbounty==stop do
	i=math.random(1,bound-am)
	wonderlandbounty=cards[i]
end
table.remove(cards,i)
am=am+1

monstroattack=wishingstar
while monstroattack==wishingstar do
	i=math.random(1,bound-am)
	monstroattack=cards[i]
end
table.remove(cards,i)
am=am+1

monstroreward=dumbo
while monstroreward==dumbo do
	i=math.random(bound-am+1,total-(am+sp))
	monstroreward=cards[i]
end
table.remove(cards,i)
sp=sp+1

halloweentownattack=pumpkinhead
while halloweentownattack==pumpkinhead do
	i=math.random(1,bound-am)
	halloweentownattack=cards[i]
end
table.remove(cards,i)
am=am+1

larxeneireward=thunder
while larxeneireward==thunder do
	i=math.random(1,bound-am)
	larxeneireward=cards[i]
end
table.remove(cards,i)
am=am+1

atlanticaattack=crabclaw
while atlanticaattack==crabclaw do
	i=math.random(1,bound-am)
	atlanticaattack=cards[i]
end
table.remove(cards,i)
am=am+1

rikuireward=aero
while rikuireward==aero do
	i=math.random(1,bound-am)
	rikuireward=cards[i]
end
table.remove(cards,i)
am=am+1

neverlandattack=fairyharp
while neverlandattack==fairyharp do
	i=math.random(1,bound-am)
	neverlandattack=cards[i]
end
table.remove(cards,i)
am=am+1

neverlandreward=tinkerbell
while neverlandreward==tinkerbell do
	i=math.random(bound-am+1,total-(am+sp))
	neverlandreward=cards[i]
end
table.remove(cards,i)
sp=sp+1

hollowbastionattack=divinerose
while hollowbastionattack==divinerose do
	i=math.random(1,bound-am)
	hollowbastionattack=cards[i]
end
table.remove(cards,i)
am=am+1

hollowbastionktr=mushu
while hollowbastionktr==mushu do
	i=math.random(bound-am+1,total-(am+sp))
	hollowbastionktr=cards[i]
end
table.remove(cards,i)
sp=sp+1

hundredacrewoodattack=spellbinder
while hundredacrewoodattack==spellbinder do
	i=math.random(1,bound-am)
	hundredacrewoodattack=cards[i]
end
table.remove(cards,i)
am=am+1

hundredacrewoodsummon=bambi
while hundredacrewoodsummon==bambi do
	i=math.random(bound-am+1,total-(am+sp))
	hundredacrewoodsummon=cards[i]
end
table.remove(cards,i)
sp=sp+1

hundredacrewooditem=elixir
while hundredacrewooditem==elixir do
	i=math.random(bound-am+1,total-(am+sp))
	hundredacrewooditem=cards[i]
end
table.remove(cards,i)
sp=sp+1

vexenreward=megaether
while vexenreward==megaether do
	i=math.random(bound-am+1,total-(am+sp))
	vexenreward=cards[i]
end
table.remove(cards,i)
sp=sp+1

destinyislandsreward=oathkeeper
while destinyislandsreward==oathkeeper do
	i=math.random(1,bound-am)
	destinyislandsreward=cards[i]
end
table.remove(cards,i)
am=am+1

destinyislandsktr=megalixir
while destinyislandsktr==megalixir do
	i=math.random(bound-am+1,total-(am+sp))
	destinyislandsktr=cards[i]
end
table.remove(cards,i)
sp=sp+1

rikuivreward=megapotion
rikuivreward=cards[5]

larxeneiireward=oblivion
while larxeneiireward==oblivion do
	i=math.random(1,bound-am)
	larxeneiireward=cards[i]
end
table.remove(cards,i)
am=am+1

postattacka=diamonddust
while postattacka==diamonddust do
	i=math.random(1,bound-am)
	postattacka=cards[i]
end
table.remove(cards,i)
am=am+1

postattackb=onewingedangel
while postattackb==onewingedangel do
	i=math.random(1,bound-am)
	postattackb=cards[i]
end
table.remove(cards,i)
am=am+1

finalattack=ultimaweapon
finalattack=cards[1]
table.remove(cards,i)

repeat
	hasattack = false
	hasmagic = false
	haswild = false
	defaultdeck={}
	cardindex=1
	value=math.random(0,4)
	defaultdeck[1]=defaultitem.id+(value*2)
	totalcp=defaultitem.cp[(value*2)+1]
	maxcp=275

	while cardindex<15 do
		cardindex=cardindex+1
		cardtype=math.random(3)
		if cardtype==1 then
			currentcard=defaultattack
			hasattack=true
		elseif cardtype==2 then
			currentcard=defaultmagic
			hasmagic=true
		elseif cardtype==3 then
			currentcard=defaultwild
			haswild=true
		end
		value=math.random(0,9)
		--if totalcp+currentcard.cp[value+1]>maxcp then
		--	break
		--else
		defaultdeck[cardindex]=currentcard.id+value
		totalcp=totalcp+currentcard.cp[value+1]
		--end
	end
until hasattack and hasmagic and haswild


memory.usememorydomain("ROM")

--Starting deck
memory.writebyte(0xAB8D0,defaultdeck[1]/2)
address=0xAB882
for i=2,14 do
	memory.writebyte(address,defaultdeck[i])
	address=address+6
end
memory.writebyte(0xAB8D8,defaultdeck[15])


--Floor keyblades
memory.writebyte(0x62C84,agrabahattack.bit)
memory.writebyte(0x62C8C,monstroattack.bit)
memory.writebyte(0x62C94,olympusattack.bit)
memory.writebyte(0x62C9C,wonderlandattack.bit)
memory.writebyte(0x62CA4,atlanticaattack.bit)
memory.writebyte(0x62CAC,neverlandattack.bit)
memory.writebyte(0x62CB4,hollowbastionattack.bit)
memory.writebyte(0x62CBC,halloweentownattack.bit)


--Fight rewards
memory.writebyte(0x62840,leonreward.id/2+math.random(0,4))
memory.writebyte(0x96B28,axelreward.id+math.random(0,9))
memory.write_u16_le(0x96BB8,banditreward.id+math.random(0,9))
memory.writebyte(0x628D0,agrabahreward.id/2+math.random(0,4))
memory.write_u16_le(0x96B4C,cloudreward.id+math.random(0,9))
memory.writebyte(0x628E4,olympusreward.id/2+math.random(0,4))
memory.write_u16_le(0x96BAC,monstroreward.id+math.random(0,4))
memory.writebyte(0x96B2E,larxeneireward.id+math.random(0,9))
memory.writebyte(0x628DA,neverlandreward.id/2+math.random(0,4))
memory.writebyte(0x96B34,rikuireward.id+math.random(0,9))
memory.writebyte(0x628EE,hundredacrewoodattack.id+math.random(0,9))
memory.write_u16_le(0x62900,hundredacrewooditem.id+math.random(0,9))
memory.write_u16_le(0x6290C,hundredacrewoodsummon.id+math.random(0,9))
memory.writebyte(0x96B68,vexenreward.id/2+math.random(0,4))
memory.writebyte(0x628B0,destinyislandsreward.id+math.random(0,9))
memory.writebyte(0x96B70,rikuivreward.id/2+math.random(0,4))
memory.writebyte(0x628A2,larxeneiireward.id+math.random(0,9))


--Drop table
memory.write_u16_le(0x185814E,defaultattack.id)
memory.write_u16_le(0x185814C,defaultattack.bit)
memory.write_u16_le(0x1858196,defaultmagic.id)
memory.write_u16_le(0x1858194,defaultmagic.bit)
memory.write_u16_le(0x18581CA,defaultitem.id)
memory.write_u16_le(0x18581C8,defaultitem.bit)
memory.write_u16_le(0x185819E,defaultwild.id)
memory.write_u16_le(0x185819C,defaultwild.bit)
memory.write_u16_le(0x18581AE,leonreward.id)
memory.write_u16_le(0x18581AC,leonreward.bit)
memory.write_u16_le(0x1858172,traversetownktr.id)
memory.write_u16_le(0x1858170,traversetownktr.bit)
memory.write_u16_le(0x1858192,axelreward.id)
memory.write_u16_le(0x1858190,axelreward.bit)
memory.write_u16_le(0x1858156,agrabahattack.id)
memory.write_u16_le(0x1858154,agrabahattack.bit)
memory.write_u16_le(0x18581A2,agrabahbounty.id)
memory.write_u16_le(0x18581A0,agrabahbounty.bit)
memory.write_u16_le(0x18581D6,banditreward.id)
memory.write_u16_le(0x18581D4,banditreward.bit)
memory.write_u16_le(0x18581B2,agrabahreward.id)
memory.write_u16_le(0x18581B0,agrabahreward.bit)
memory.write_u16_le(0x1858152,olympusattack.id)
memory.write_u16_le(0x1858150,olympusattack.bit)
memory.write_u16_le(0x18581CE,cloudreward.id)
memory.write_u16_le(0x18581CC,cloudreward.bit)
memory.write_u16_le(0x18581C6,olympusreward.id)
memory.write_u16_le(0x18581C4,olympusreward.bit)
memory.write_u16_le(0x185816E,olympusktr.id)
memory.write_u16_le(0x185816C,olympusktr.bit)
memory.write_u16_le(0x1858176,wonderlandattack.id)
memory.write_u16_le(0x1858174,wonderlandattack.bit)
memory.write_u16_le(0x18581A6,wonderlandbounty.id)
memory.write_u16_le(0x18581A4,wonderlandbounty.bit)
memory.write_u16_le(0x1858166,monstroattack.id)
memory.write_u16_le(0x1858164,monstroattack.bit)
memory.write_u16_le(0x18581BA,monstroreward.id)
memory.write_u16_le(0x18581B8,monstroreward.bit)
memory.write_u16_le(0x185815E,halloweentownattack.id)
memory.write_u16_le(0x185815C,halloweentownattack.bit)
memory.write_u16_le(0x185819A,larxeneireward.id)
memory.write_u16_le(0x1858198,larxeneireward.bit)
memory.write_u16_le(0x185815A,atlanticaattack.id)
memory.write_u16_le(0x1858158,atlanticaattack.bit)
memory.write_u16_le(0x18581AA,rikuireward.id)
memory.write_u16_le(0x18581A8,rikuireward.bit)
memory.write_u16_le(0x1858162,neverlandattack.id)
memory.write_u16_le(0x1858160,neverlandattack.bit)
memory.write_u16_le(0x18581BE,neverlandreward.id)
memory.write_u16_le(0x18581BC,neverlandreward.bit)
memory.write_u16_le(0x185817A,hollowbastionattack.id)
memory.write_u16_le(0x1858178,hollowbastionattack.bit)
memory.write_u16_le(0x18581C2,hollowbastionktr.id)
memory.write_u16_le(0x18581C0,hollowbastionktr.bit)
memory.write_u16_le(0x185816A,hundredacrewoodattack.id)
memory.write_u16_le(0x1858168,hundredacrewoodattack.bit)
memory.write_u16_le(0x18581B6,hundredacrewoodsummon.id)
memory.write_u16_le(0x18581B4,hundredacrewoodsummon.bit)
memory.write_u16_le(0x18581DE,hundredacrewooditem.id)
memory.write_u16_le(0x18581DC,hundredacrewooditem.bit)
memory.write_u16_le(0x18581DA,vexenreward.id)
memory.write_u16_le(0x18581D8,vexenreward.bit)
memory.write_u16_le(0x185817E,destinyislandsreward.id)
memory.write_u16_le(0x185817C,destinyislandsreward.bit)
memory.write_u16_le(0x18581E2,destinyislandsktr.id)
memory.write_u16_le(0x18581E0,destinyislandsktr.bit)
memory.write_u16_le(0x18581D2,rikuivreward.id)
memory.write_u16_le(0x18581D0,rikuivreward.bit)
memory.write_u16_le(0x1858182,larxeneiireward.id)
memory.write_u16_le(0x1858180,larxeneiireward.bit)
memory.write_u16_le(0x185818A,postattacka.id)
memory.write_u16_le(0x1858188,postattacka.bit)
memory.write_u16_le(0x185818E,postattackb.id)
memory.write_u16_le(0x185818C,postattackb.bit)
memory.write_u16_le(0x1858186,finalattack.id)
memory.write_u16_le(0x1858184,finalattack.bit)

--Shop table
memory.writebyte(0x10410E,defaultattack.id)
memory.writebyte(0x104112,defaultmagic.id)
memory.writebyte(0x104116,defaultitem.id/2)
memory.write_u16_le(0x1993348,defaultattack.id)
memory.write_u16_le(0x199334C,defaultattack.bit)
memory.write_u16_le(0x19934B8,defaultmagic.id)
memory.write_u16_le(0x19934BC,defaultmagic.bit)
memory.write_u16_le(0x1993538,defaultitem.id)
memory.write_u16_le(0x199353C,defaultitem.bit)
memory.write_u16_le(0x1993468,defaultwild.id)
memory.write_u16_le(0x199346C,defaultwild.bit)
memory.write_u16_le(0x19934C8,leonreward.id)
memory.write_u16_le(0x19934CC,leonreward.bit)
memory.write_u16_le(0x19933D8,traversetownktr.id)
memory.write_u16_le(0x19933DC,traversetownktr.bit)
memory.write_u16_le(0x1993458,axelreward.id)
memory.write_u16_le(0x199345C,axelreward.bit)
memory.write_u16_le(0x1993358,agrabahattack.id)
memory.write_u16_le(0x199335C,agrabahattack.bit)
memory.write_u16_le(0x1993488,agrabahbounty.id)
memory.write_u16_le(0x199348C,agrabahbounty.bit)
memory.write_u16_le(0x1993548,banditreward.id)
memory.write_u16_le(0x199354C,banditreward.bit)
memory.write_u16_le(0x19934D8,agrabahreward.id)
memory.write_u16_le(0x19934DC,agrabahreward.bit)
memory.write_u16_le(0x1993398,olympusattack.id)
memory.write_u16_le(0x199339C,olympusattack.bit)
memory.write_u16_le(0x1993558,cloudreward.id)
memory.write_u16_le(0x199355C,cloudreward.bit)
memory.write_u16_le(0x1993528,olympusreward.id)
memory.write_u16_le(0x199352C,olympusreward.bit)
memory.write_u16_le(0x19933A8,olympusktr.id)
memory.write_u16_le(0x19933AC,olympusktr.bit)
memory.write_u16_le(0x1993388,wonderlandattack.id)
memory.write_u16_le(0x199338C,wonderlandattack.bit)
memory.write_u16_le(0x1993498,wonderlandbounty.id)
memory.write_u16_le(0x199349C,wonderlandbounty.bit)
memory.write_u16_le(0x1993378,monstroattack.id)
memory.write_u16_le(0x199337C,monstroattack.bit)
memory.write_u16_le(0x19934F8,monstroreward.id)
memory.write_u16_le(0x19934FC,monstroreward.bit)
memory.write_u16_le(0x1993368,halloweentownattack.id)
memory.write_u16_le(0x199336C,halloweentownattack.bit)
memory.write_u16_le(0x1993478,larxeneireward.id)
memory.write_u16_le(0x199347C,larxeneireward.bit)
memory.write_u16_le(0x19933B8,atlanticaattack.id)
memory.write_u16_le(0x19933BC,atlanticaattack.bit)
memory.write_u16_le(0x19934A8,rikuireward.id)
memory.write_u16_le(0x19934AC,rikuireward.bit)
memory.write_u16_le(0x19933C8,neverlandattack.id)
memory.write_u16_le(0x19933CC,neverlandattack.bit)
memory.write_u16_le(0x1993508,neverlandreward.id)
memory.write_u16_le(0x199350C,neverlandreward.bit)
memory.write_u16_le(0x19933F8,hollowbastionattack.id)
memory.write_u16_le(0x19933FC,hollowbastionattack.bit)
memory.write_u16_le(0x1993518,hollowbastionktr.id)
memory.write_u16_le(0x199351C,hollowbastionktr.bit)
memory.write_u16_le(0x19933E8,hundredacrewoodattack.id)
memory.write_u16_le(0x19933EC,hundredacrewoodattack.bit)
memory.write_u16_le(0x19934E8,hundredacrewoodsummon.id)
memory.write_u16_le(0x19934EC,hundredacrewoodsummon.bit)
memory.write_u16_le(0x1993588,hundredacrewooditem.id)
memory.write_u16_le(0x199358C,hundredacrewooditem.bit)
memory.write_u16_le(0x1993568,vexenreward.id)
memory.write_u16_le(0x199356C,vexenreward.bit)
memory.write_u16_le(0x1993408,destinyislandsreward.id)
memory.write_u16_le(0x199340C,destinyislandsreward.bit)
memory.write_u16_le(0x1993598,destinyislandsktr.id)
memory.write_u16_le(0x199359C,destinyislandsktr.bit)
memory.write_u16_le(0x1993578,rikuivreward.id)
memory.write_u16_le(0x199357C,rikuivreward.bit)
memory.write_u16_le(0x1993418,larxeneiireward.id)
memory.write_u16_le(0x199341C,larxeneiireward.bit)
memory.write_u16_le(0x1993428,postattacka.id)
memory.write_u16_le(0x199342C,postattacka.bit)
memory.write_u16_le(0x1993438,postattackb.id)
memory.write_u16_le(0x199343C,postattackb.bit)
memory.write_u16_le(0x1993448,finalattack.id)
memory.write_u16_le(0x199344C,finalattack.bit)

--Enemy cards
oldenemycards={shadow,soldier,largebody,rednocturne,bluerhapsody,yellowopera,greenrequiem,powerwild,bouncywild,airsoldier,bandit,fatbandit,barrelspider,searchghost,seaneon,screwdiver,aquatank,wightknight,gargoyle,pirate,airpirate,darkball,defender,wyvern,wizard,neoshadow,whitemushroom,blackfungus,creeperplant,tornadostep,crescendo,guardarmor,parasitecage,trickmaster,cardsoldier,hades,oogieboogie,ursula,hook,riku,axel,larxene,marluxia,lexaeus,ansem}
oldenemycardsdiv4={darkside,jafar,dragonmaleficent,vexen}
enemycardsremaining = {unpack(oldenemycards)}

for i=table.getn(oldenemycards),1,-1 do
	if (oldenemycards[i].id % 4 == 0) then
		table.insert(oldenemycardsdiv4,oldenemycards[i])
		table.remove(enemycardsremaining,i)
	end
end

repeat
	enemycardsdiv4={unpack(oldenemycardsdiv4)}
	newenemycardsdiv4={}
	for i=1,table.getn(oldenemycardsdiv4) do
		newenemycardsdiv4[i]=oldenemycardsdiv4[i]
		while newenemycardsdiv4[i]==oldenemycardsdiv4[i] do
			index=math.random(1,table.getn(enemycardsdiv4))
			newenemycardsdiv4[i]=enemycardsdiv4[index]
		end
		table.remove(enemycardsdiv4,index)
	end
until newenemycardsdiv4[table.getn(newenemycardsdiv4)]~=oldenemycardsdiv4[table.getn(oldenemycardsdiv4)]

memory.writebyte(darkside.address,newenemycardsdiv4[1].id/4)
memory.writebyte(jafar.address,newenemycardsdiv4[2].id/4)
memory.writebyte(dragonmaleficent.address,newenemycardsdiv4[3].id/4)
memory.writebyte(vexen.address,newenemycardsdiv4[4].id/4)

if spoilers==true then
	console.clear()
	print("Darkside Enemy Card: "..newenemycardsdiv4[1].name)
	print("Jafar Enemy Card: "..newenemycardsdiv4[2].name)
	print("Dragon Maleficent Enemy Card: "..newenemycardsdiv4[3].name)
	print("Vexen Enemy Card: "..newenemycardsdiv4[4].name)
end

table.remove(newenemycardsdiv4,4)
table.remove(newenemycardsdiv4,3)
table.remove(newenemycardsdiv4,2)
table.remove(newenemycardsdiv4,1)

for _, v in pairs(newenemycardsdiv4) do
	table.insert(enemycardsremaining,v)
end

repeat
	enemycards={unpack(enemycardsremaining)}
	newenemycards={}
	for i=1,table.getn(oldenemycards) do
		newenemycards[i]=oldenemycards[i]
		while newenemycards[i]==oldenemycards[i] do
			index=math.random(1,table.getn(enemycards))
			newenemycards[i]=enemycards[index]
		end
		table.remove(enemycards,index)
	end
until newenemycards[table.getn(newenemycards)]~=oldenemycards[table.getn(oldenemycards)]

for i=1,table.getn(newenemycards) do
	memory.write_u16_le(oldenemycards[i].address,newenemycards[i].id)
end

--Spoiler display
if spoilers==true then
	print()
	print("Default Attack: "..defaultattack.name)
	print("Default Magic: "..defaultmagic.name)
	print("Default Item: "..defaultitem.name)
	print("Default Wildcard: "..defaultwild.name)
	print()
	print("Leon Reward: "..leonreward.name)
	print("Traverse Town KTR: "..traversetownktr.name)
	print("Axel I Reward: "..axelreward.name)
	print("Agrabah Attack: "..agrabahattack.name)
	print("Agrabah Bounty: "..agrabahbounty.name)
	print("Bandit Reward: "..banditreward.name)
	print("Agrabah Reward: "..agrabahreward.name)
	print("Olympus Attack: "..olympusattack.name)
	print("Cloud Reward: "..cloudreward.name)
	print("Olympus Reward: "..olympusreward.name)
	print("Olympus KTR: "..olympusktr.name)
	print("Wonderland Attack: "..wonderlandattack.name)
	print("Wonderland Bounty: "..wonderlandbounty.name)
	print("Monstro Attack: "..monstroattack.name)
	print("Monstro Reward: "..monstroreward.name)
	print("Halloween Town Attack: "..halloweentownattack.name)
	print("Larxene I Reward: "..larxeneireward.name)
	print("Atlantica Attack: "..atlanticaattack.name)
	print("Riku I Reward: "..rikuireward.name)
	print("Neverland Attack: "..neverlandattack.name)
	print("Neverland Reward: "..neverlandreward.name)
	print("Hollow Bastion Attack: "..hollowbastionattack.name)
	print("Hollow Bastion KTR: "..hollowbastionktr.name)
	print("100 Acre Wood Attack: "..hundredacrewoodattack.name)
	print("100 Acre Wood Summon: "..hundredacrewoodsummon.name)
	print("100 Acre Wood Item: "..hundredacrewooditem.name)
	print("Vexen I Reward: "..vexenreward.name)
	print("Destiny Islands Reward: "..destinyislandsreward.name)
	print("Destiny Islands KTR: "..destinyislandsktr.name)
	print("Riku III Reward: "..rikuivreward.name)
	print("Larxene II Reward: "..larxeneiireward.name)
	print("Post-game Attack A: "..postattacka.name)
	print("Post-game Attack B: "..postattackb.name)
	print("Final Attack: "..finalattack.name)
	print()
	for i=1,table.getn(newenemycards) do
		print(oldenemycards[i].name.." Enemy Card: "..newenemycards[i].name)
	end
end

joypad.set({["A"]=true,["B"]=true,["Select"]=true,["Start"]=true})